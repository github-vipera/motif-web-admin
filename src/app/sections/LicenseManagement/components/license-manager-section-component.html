<wc-loading-overlay [visible]='loading'></wc-loading-overlay>
<wc-dashboard-header [title]="'License Manager'"></wc-dashboard-header>

<input type="file" id="xmlFileImport" name="xmlFileImport"  (change)="onUploadFileSelected($event)" #xmlFileImport>

<div class="row spread">

    <div class="flex-toolbar" style="display:flex;align-items: center;">
        <div>
            <label>&nbsp;</label>
            <kendo-buttongroup look="flat">
                <button kendoButton [toggleable]="false" (click)="onImportClicked($event)" ><fa-icon [icon]="faFileImport"></fa-icon>Import License</button>
            </kendo-buttongroup>
        </div>
    </div>

    <div class="flex-cmd">
        <kendo-buttongroup look="flat">
            <button kendoButton [toggleable]="false" [icon]="'refresh'" (click)="onRefreshClicked()">Refresh</button>
        </kendo-buttongroup>
    </div>

</div>

<div class="row fill">

    <div>

    <wc-slide-panel #uploadSlideDownPanel (close)="onSlideEditorClose()">
        <div class="wc-slide-down-editor-pane" style="display:flex;height: 45px;">
            <div style="width:350px;height: 100%;">
                    <wc-file-drop-panel #fileDrop></wc-file-drop-panel>
            </div>
        </div>

        <div class="cmd" style="align-items: center;">
            <label style="padding-bottom: 0px;padding-left: 10px;padding-right: 10px;">Do Upload?</label>
            <a (click)="onLicenseUploadConfirm()">
                <svg class="ok" data-id="ok">
                    <use xlink:href="assets/img/icons.svg#ico-ok"></use>
                </svg>
            </a>
            <a (click)="onLicenseUploadCancel()" data-slideup="#user-add">
                <svg class="ko" data-id="ko">
                    <use xlink:href="assets/img/icons.svg#ico-ko"></use>
                </svg>
            </a>
        </div>
    </wc-slide-panel>

        <kendo-grid #datagrid [data]="_licenses" 
                [navigable]="false"> 

                <kendo-grid-column
                    field="productName" title="Product Name" >
                </kendo-grid-column>

                <kendo-grid-column
                    field="productVersion" title="Product Version" width="360">
                </kendo-grid-column>

                <kendo-grid-column
                    field="issueDate" title="Issue Date" width="360" format="{0:dd/MM/yyyy HH:mm:ss}">
                </kendo-grid-column>

                <kendo-grid-column
                    field="expiryDate" title="Expiry Date" width="360" format="{0:dd/MM/yyyy HH:mm:ss}">
                </kendo-grid-column>

                <kendo-grid-column title="" width="150" minResizableWidth="140">
                        <ng-template kendoGridCellTemplate let-dataItem let-columnIndex="columnIndex" let-rowIndex="rowIndex" let-column="column">
                                <wc-grid-editor 
                                [question]="'Revoke ?'" 
                                [rowIndex]="rowIndex" 
                                [columnIndex]="columnIndex" 
                                [column]="column" 
                                [value]="dataItem[column.field]" 
                                [dataItem]="dataItem"
                                [buttonClass]="''" 
                                [mainClass]="'wc-table-delete-command'"
                                (onConfirmation)="onDeleteOKPressed(dataItem)">
                                    <svg data-id="no"><use xlink:href="assets/img/icons.svg#ico-no"></use></svg>
                                </wc-grid-editor>
                        </ng-template>
                </kendo-grid-column>

                <div *kendoGridDetailTemplate="let dataItem">
                    <wa-license-details [licenseItem]="dataItem"></wa-license-details>
                </div>
    
            </kendo-grid>

        </div>

<!--
"id": 820,
			"productName": "ViperaOSGI",
			"productVersion": "2.1",
			"issueDate": 1530474457803,
			"expiryDate": 1893527257803,
			"maxUserNumber": 100,
			"license": "1iPNsNJNE+YxqW7zkfUVn8/nYWJ3RTD8vj6YwZ+GFJb2Hthhw24l5evGaYV1Pj/50/cjcnNmwOYhEU/1/7O5X8HY9Ebs3n65HWtzf/ZonoY7yAe8bR8xv5u+rAhvdKApJlB4VDmVkt8tDcp2Lf8X4yHkTBlJXdBmsAWu3k2Vses=",
			"customerName": "Motif_2.1.dev_WEBCONSOLE",
			"customerEmail": "marco.tormento@vipera.com"
-->
</div>
